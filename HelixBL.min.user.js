// ==UserScript==
// @name         HelixBL
// @namespace    https://infinity-atom.org
// @version      1.4.72
// @description  Utility script that makes blooket easier
// @author       infinity-atom
// @match        http*://*.blooket.com/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=blooket.com
// @grant        none
// ==/UserScript==

console.log("helixbl 1.4.72");const elements={commandBox:document.createElement("input"),commandSuggestions:document.createElement("ul")};function openCmdBox(e){elements.commandBox.style.display="block",elements.commandBox.focus(),elements.commandBox.value=e??""}document.body.innerHTML+="<style>.helixbl-a-esp { font-weight: bold; }</style>",elements.commandBox.style.position="absolute",elements.commandBox.style.bottom="0",elements.commandBox.style.left="0",elements.commandBox.style.width="100vw",elements.commandBox.style.height="30px",elements.commandBox.style.fontSize="12pt",elements.commandBox.style.border="none",elements.commandBox.style.outline="none",elements.commandBox.style.backgroundColor="rgba(0, 0, 0, 0.5)",elements.commandBox.style.color="white",elements.commandBox.style.paddingLeft="10px",elements.commandBox.style.boxSizing="border-box",elements.commandBox.placeholder="helixbl v1.0",elements.commandBox.style.fontFamily="Consolas, monospace",elements.commandBox.style.display="none",elements.commandSuggestions.style.position="absolute",elements.commandSuggestions.style.bottom="30px",elements.commandSuggestions.style.left="0px",elements.commandSuggestions.style.minWidth="200px",elements.commandSuggestions.style.fontSize="12pt",elements.commandSuggestions.style.listStyleType="none",elements.commandSuggestions.style.padding="0",elements.commandSuggestions.style.margin="0",elements.commandSuggestions.style.marginLeft="10px",elements.commandSuggestions.style.backgroundColor="rgba(0, 0, 0, 0.5)",elements.commandSuggestions.style.color="white",elements.commandSuggestions.style.fontFamily="Consolas, monospace",elements.commandSuggestions.style.display="none",document.body.appendChild(elements.commandBox),document.body.appendChild(elements.commandSuggestions),document.addEventListener("keyup",(e=>{"|"==e.key&&(elements.commandBox.style.display="block",elements.commandBox.focus(),elements.commandBox.value="",handleSuggestion()),"Escape"==e.key&&"block"==elements.commandBox.style.display&&(elements.commandBox.style.display="none",elements.commandSuggestions.style.display="none"),"Enter"==e.key&&"block"==elements.commandBox.style.display&&(elements.commandBox.style.display="none",elements.commandSuggestions.style.display="none",run())}));class SuggestionUtil{static suggestions=[];static showSuggestions(e){elements.commandSuggestions.style.display="block",elements.commandSuggestions.innerHTML=SuggestionUtil.suggestions.map((e=>`<li>${e}</li>`)).join(""),elements.commandSuggestions.style.left=8.8*e+"px"}static hideSuggestions(){elements.commandSuggestions.style.display="none"}}const reactHandler=()=>Object.values(document.querySelector("#app > div > div"))[1].children[1]._owner;let moduleToggles={autoAnswer:!1,answerEsp:!1,chestEsp:!1,autoChest:!1,autoPassword:!1};const modules={global:{"auto-answer":{gS:e=>e.length<=3?["enable","disable"]:[],exec:e=>{if(!e[0])throw"Missing argument.";if("enable"==e[0])moduleToggles.autoAnswer=!0;else{if("disable"!=e[0])throw"Invalid argument.";moduleToggles.autoAnswer=!1}}},"answer-esp":{gS:e=>e.length<=3?["enable","disable"]:[],exec:e=>{if(!e[0])throw"Missing argument.";if("enable"==e[0])moduleToggles.answerEsp=!0;else{if("disable"!=e[0])throw"Invalid argument.";moduleToggles.answerEsp=!1}}},"hide-name":{gS:e=>[],exec:e=>{document.querySelector("._headerTextLeft_sahgi_44").innerText=""}}},crypto:{"auto-password":{gS:e=>e.length<=3?["enable","disable"]:[],exec:e=>{if(!e[0])throw"Missing argument.";if("enable"==e[0])moduleToggles.autoPassword=!0;else{if("disable"!=e[0])throw"Invalid argument.";moduleToggles.autoPassword=!1}}}},"gold-quest":{"chest-esp":{gS:e=>e.length<=3?["enable","disable"]:[],exec:e=>{if(!e[0])throw"Missing argument.";if("enable"==e[0])moduleToggles.chestEsp=!0;else{if("disable"!=e[0])throw"Invalid argument.";moduleToggles.chestEsp=!1}}},"auto-chest":{gS:e=>e.length<=3?["enable","disable"]:[],exec:e=>{if(!e[0])throw"Missing argument.";if("enable"==e[0])moduleToggles.autoChest=!0;else{if("disable"!=e[0])throw"Invalid argument.";moduleToggles.autoChest=!1}}}}},handleSuggestion=()=>{const e=elements.commandBox.value,t=e.split(" "),s=t[0]??null,o=t[1]??null,n=t.slice(2)??[];if(s&&s in modules)return o&&o in modules[s]?modules[s][o]?(SuggestionUtil.suggestions=modules[s][o].gS(n),void SuggestionUtil.showSuggestions(e.length)):void SuggestionUtil.hideSuggestions():(SuggestionUtil.suggestions=Object.keys(modules[s]),void SuggestionUtil.showSuggestions(e.length));SuggestionUtil.suggestions=Object.keys(modules),SuggestionUtil.showSuggestions(e.length)};function run(){const e=elements.commandBox.value,t=e.split(" "),s=t[0]??null,o=t[1]??null,n=t.slice(2)??[];if(""!=e.trim()&&!e.startsWith("Error:"))if(s&&s in modules){if(o&&o in modules[s])try{return void modules[s][o].exec(n)}catch(e){return void openCmdBox(`Error: ${e}`)}openCmdBox("Error: Module in category not found.")}else openCmdBox("Error: Category not found.")}elements.commandBox.addEventListener("input",handleSuggestion),setInterval((()=>{if(moduleToggles.chestEsp)try{if("prize"==reactHandler().stateNode.state.stage){let e=reactHandler().stateNode.state.choices,t=document.querySelector("div[class*='regularBody']").children[1];t&&0==document.querySelectorAll(".helixbl-chest-esp").length&&e.forEach(((e,s)=>{let o=document.createElement("div");o.classList.add("helixbl-chest-esp"),o.innerText=e.text,o.style.fontFamily="sans-serif",o.style.fontSize="30px",o.style.marginTop="200px";try{t.children[s].appendChild(o)}catch{}}))}}catch{}if(moduleToggles.autoChest)try{if("prize"==reactHandler().stateNode.state.stage){if(document.querySelector("div[class*='regularBody']").children[1]){let e=reactHandler().stateNode.state.choices;const t={divide:0,nothing:1,swap:10,gold:50,take:100,multiply:1e3};e=e.map((e=>t[e.type]*(e.val??1)));let s=e.reduce(((e,t,s,o)=>t>o[e]?s:e),0);document.querySelector("div[class*='regularBody']").children[1].children[s].click()}}}catch{}if(moduleToggles.auto)try{Array.from(document.body.querySelectorAll('div[class*="answerText"]')).filter((e=>e.firstChild.innerHTML==reactHandler().memoizedState.question.correctAnswers[0]))[0].click()}catch{try{Array.from(document.body.querySelectorAll('div[class*="answerText"]')).filter((e=>e.firstChild.innerHTML==reactHandler().memoizedProps.client.question.correctAnswers[0]))[0].click()}catch{}}if(moduleToggles.answerEsp){if(0!=document.body.querySelectorAll(".helixbl-a-esp").length)return;try{Array.from(document.body.querySelectorAll('div[class*="answerText"]')).filter((e=>e.firstChild.innerHTML==reactHandler().memoizedState.question.correctAnswers[0]))[0].innerHTML+='<span class="helixbl-a-esp">[&loz;]</span>'}catch{try{Array.from(document.body.querySelectorAll('div[class*="answerText"]')).filter((e=>e.firstChild.innerHTML==reactHandler().memoizedProps.client.question.correctAnswers[0]))[0].innerHTML+='<span class="helixbl-a-esp">[&loz;]</span>'}catch{}}}if(moduleToggles.autoPassword){let{stage:e,correctPassword:t}=reactHandler().stateNode.state;"hack"==e&&Array.from(document.querySelector("div")).filter((e=>e.innerHTML==t))[0].click()}}));
